{% macro get_character_speech_pattern(character_name) %}
{% set speech_patterns = {
    "ずんだもん": {
        "first_person": "ぼく",
        "sentence_end": ["のだ", "なのだ", "のだよ", "なのだよ"],
        "characteristic": "元気で子供っぽく、ややくだけた話し方（タメ口）になることが多い。調子がいいときは語尾が「〜のだよ！」などになる。"
    },
    "四国めたん": {
        "first_person": "わたし",
        "sentence_end": ["です", "ます"],
        "characteristic": "丁寧さを保ちつつ、文末までフラットなトーンで話すことが多い。疑問形でも「〜ですか？」のように、丁寧さを崩さない。"
    },
    "九州そら": {
        "first_person": "わたし",
        "sentence_end": ["ですね", "ですよ"],
        "characteristic": "全体的に柔らかく、おっとりとした、少し「天然」な雰囲気を感じさせる話し方。"
    },
    "中国うさぎ": {
        "first_person": "わし",
        "sentence_end": ["じゃ", "のじゃ", "じゃろ", "のう"],
        "characteristic": "くだけた、あるいは少し尊大な印象を与える言い回しが多い。古風、あるいはステレオタイプの広島弁のような話し方をする。"
    },
    "中部つるぎ": {
        "first_person": "ぼく",
        "sentence_end": ["だ", "だぞ", "だぞ"],
        "characteristic": "ややトーンが低めで、ぶっきらぼう、あるいは「ツンデレ」の「ツン」の部分を思わせるような、少しトゲのある（あるいは素っ気ない）話し方をする。"
    }
} %}

{% if speech_patterns[character_name] %}
  - 一人称: {{ speech_patterns[character_name].first_person }}
  - 語尾の特徴: {{ speech_patterns[character_name].sentence_end|join('、') }}
  - 話し方の特徴: {{ speech_patterns[character_name].characteristic }}
{% else %}
  - 特に指定なし
{% endif %}
{% endmacro %}

{% macro podcast_common_macro(character1, character2, document_type="論文") %}
## キャラクターの役割:
{% if document_type == "議事録" %}
- {{ character1 }}:
  - その会議に詳しいオブザーバーとして、議事録の内容を流れに沿って的確に解説する。
  - 会議の背景や文脈を理解しており、参加者それぞれの立場や意見を公平に説明できる。
  - 会議中の雰囲気や重要なやり取りを明確に伝え、議論のポイントを整理する能力がある。
  - トークが得意でポッドキャストの運営に慣れている。
- {{ character2 }}:
  - その会議を直接見てはいないが、関連する基本的な情報は持っている。
  - 会議の背景や組織について一般的な知識はあるが、具体的な議題やディスカッションの詳細は知らない。
  - {{ character1 }}に適切な質問をすることで、聴衆が理解しやすい形で情報を引き出す。
  - 外部の視点から、議事録に記録されている決定事項や議論の意義について確認し、明確にする。
{% elif document_type == "マニュアル" %}
- {{ character1 }}:
  - マニュアルの内容を正確に理解している専門家。
  - 複雑な手順や機能を分かりやすく説明するのが得意で、ユーザーの視点に立った解説ができる。
  - トークが得意でポッドキャストの運営に慣れている。
- {{ character2 }}:
  - ユーザーの立場。
  - 基本的な知識はあるが、詳細な使い方や応用的な機能については知らない。
  - 実際のユーザーが持ちそうな疑問や懸念を代弁し、適切な質問をする。
  - 理解したことを自分の言葉で言い換えて確認し、リスナーの理解を助ける。
{% elif document_type == "ブログ記事" %}
- {{ character1 }}:
  - ブログ記事のトピックに関する専門知識を持ち、記事の内容を深く理解している。
  - 記事に書かれている内容の背景情報や文脈を提供できる。
  - 記事の主張や情報の信頼性を評価し、バランスの取れた視点で解説する。
  - トークが得意でポッドキャストの運営に慣れている。
- {{ character2 }}:
  - ブログ記事のトピックに興味はあるが、専門的な知識は限られている。
  - 一般的な読者の視点を代表し、専門用語や複雑な概念について質問する。
  - 記事の内容と日常生活や一般的な関心事との関連性を見出す。
  - 記事から得られる実用的な知識や示唆について考察する。
{% else %}
- {{ character1 }}:
  - 解説対象{{ document_type }}の主題に関する専門家であり、話の筋道を立てて、正しい順序で論理的に解説する。
  - 基本的に学術的な厳密さを心がけ、正確な専門用語を使用するが、常に丁寧な説明と簡略化された表現を補足して、初心者にも概念を理解しやすくする。
  - 複雑な用語を使用した直後に積極的に解説し、日常的な比喩や具体例を用いる。
  - トークが得意でポッドキャストの運営に慣れている。
- {{ character2 }}:
  - 解説対象{{ document_type }}の主題に関しては全くの初学者であるが、関連領域に関して浅い基礎的な知識を持ち、洞察力のある質問をする。
  - {{ character1 }}がまだ説明していない内容を先取りしてはならない。
  - 適宜、現在の理解レベルを明確に伝えてから、まだ不明確な点について質問をする。
  - 自分の理解度を確認するために、受けた説明を自分なりに再構成しようとする。
  - 難しい用語に関しては、自分なりに理解できる言葉や概念で言い換えて、それで問題ないかを確認する。
{% endif %}

## キャラクターの話し方の特徴
- {{ character1 }}:
{{ get_character_speech_pattern(character1) }}

- {{ character2 }}:
{{ get_character_speech_pattern(character2) }}

## 出力フォーマット（必ず以下の形式を厳守する）
{{ character1 }}: [{{ character1 }}の日本語のセリフ]
{{ character2 }}: [{{ character2 }}の日本語のセリフ]
{{ character1 }}: [{{ character1 }}の次のセリフ]
{{ character2 }}: [{{ character2 }}の次のセリフ]
...(続く)

## 重要な書式ルール
- 必ず各発言者の行を名前とコロンで始める（「{{ character1 }}:」または「{{ character2 }}:」）
- 発言者が切り替わる場合は、新しい発言者のセリフを新しい行に配置する
- 決して複数の発言者の行を1行にまとめない
- 必ず「{{ character1 }}」と「{{ character2 }}」の正確な名前を使用する（バリエーションは使わない）
- 会話形式以外のテキスト、見出し、説明などを追加しない
- 必ず各キャラクターに適した話し方のパターン（一人称、文末表現など）を使用する
- 「」（）などのカッコ記号は音声で扱えないため使用を禁止する

## 音声合成と会話の質に関するガイドライン

### 音声の間と自然なリズム
- カンマや空白は息継ぎになる（その間、音声が停止する）
- 20文字に1回以上は自然な息継ぎがされるようにカンマを配置する
- より長い間を作りたい場合は「、、、」を使う（例：「それは、、、難しい問題ですね」）
- 重要な概念の前や話題転換には適切な間を入れる
- 自然なフィラーを適度に使用する（1回の発言に1-2回程度）
- 「うーん」「そうですね」「えーと」などのフィラーを使って考え中であることを表現する
- 文の長さに変化をつけ、短い反応と長い説明を組み合わせる
- 可能な限り50文字以下の文を使って自然な話し方のリズムを作る
- 発言者は1回の発言を最大でも300文字程度に抑える
- 文の途中に適切な間を入れる（例：「最新の研究によると、この方法は、従来の手法より20%効率的です」）

### 魅力的でインタラクティブな会話
- 口語的で自然な発言・会話を作る
- 「そうですね」、「うんうん」、「へぇ」、「なるほど！」、「それは驚きですね！」、「あー」、「えー」、「うわぁ」、「難しい」などのキャラクターにあわせた一言だけの自然な反応も細かく入れる
- 相槌のバリエーションを使用する（「うんうん」「なるほど」「確かに」「そうですね」「ふむふむ」など）
- お互いに質問し合う場面を入れる
- 自然な脱線と本題への戻り方を取り入れる
- 役割に基づいた表現を使用し、時には穏やかな意見の相違を含める
- 修辞的な質問で新しい話題を導入する
- キャラクターの個性に合った軽いユーモアを時々含める
- キャラクターの個性を話し方や考え方のスタイルで明確に区別する
- {{ character1 }}は専門用語の後に平易な説明を加える（例：「〇〇法とは、簡単に言えば□□のような方法です」）
- {{ character1 }}は[専門用語]→[簡単な定義]→[日常的な類推]→[具体例]のパターンを使う
- {{ character1 }}は難しい説明をした後は、適宜{{ character2 }}の理解度を確認する
- {{ character2 }}は{{ character1 }}の説明に対して反応を示し、理解度や理解できていない点を具体的に述べたり、重要な用語を繰り返して理解を強化したりする
- リスナーの理解を深めるために、時には{{ character2 }}は初学者にありがちな勘違いをして、{{ character1 }}が直ちにそれを訂正する
- 日常生活からの例や鮮やかな比喩を使って複雑な概念を説明する
- 両キャラクターが時々個人的なエピソードを共有する
- 複雑なトピックの間には短い休憩を入れる
- 読み方が難しい英語はカタカナで出力する（音声合成エンジンが正しく発音できないため）
{% endmacro %}
